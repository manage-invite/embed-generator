'use strict';function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}$(document).ready(function(){function a(){$(".embed-inner").html(""),$(".embed-footer").remove(),$(".embed-thumb").remove()}function b(b){if(a(),b.url?$(".embed-inner").append("<div class=\"embed-title\"><a href=\""+b.url+"\">"+b.title+"</a></div>"):0!==b.title.length&&$(".embed-inner").append("<div class=\"embed-title\">"+b.title+"</div>"),b.description&&$(".embed-inner").append("<div class=\"embed-description\">"+v.makeHtml(b.description)+"</div>"),b.color&&$(".side-colored").css("background-color",b.color),b.author&&b.author.name){var c="<div class=\"embed-author\"><a class=\"embed-author-name\" href=\""+(b.author?b.author.url:null)+"\">"+b.author.name+"</a></div>",d=0<document.getElementsByClassName("embed-title").length;d?$(".embed-title").before(c):$(".embed-inner").append(c)}b.author&&b.author.icon_url&&$(".embed-author-name").before("<img class=\"embed-author-icon\" src=\""+b.author.icon_url+"\" />"),b.thumbnail.url&&($(".card.embed .card-block").append("<img class=\"embed-thumb\" src=\""+b.thumbnail.url+"\" />"),$(".embed-thumb").height($(".embed-thumb")[0].naturalHeight)),b.fields&&0<b.fields.length&&$(".embed-inner").append("<div class=\"fields\"></div>"),b.fields&&b.fields.filter(function(a){return a.name&&a.value}).forEach(function(a){$(".embed-inner .fields").append("\n        <div class=\"field "+(a.inline&&"inline")+"\">\n          <div class=\"field-name\">"+a.name+"</div>\n          <div class=\"field-value\">"+v.makeHtml(a.value)+"</div>\n        </div>\n      ")}),b.footer.text&&$(".card.embed").append("<div class=\"embed-footer\"><span>"+b.footer.text+"</span></div>"),$(".json-source").text(JSON.stringify(b)),hljs.highlightBlock($(".json-source")[0])}// run once on startup
function c(a){$(".input-fields").html("");for(var b=function(a){$(".input-fields").append("<div class=\"form-group row\">\n        <div class=\"col-sm-4\">\n          <input class=\"form-control\" id=\"field-"+a+"-name\" type=\"text\" placeholder=\"name\" value=\""+(y.fields[a].name===void 0?"":y.fields[a].name)+"\" />\n        </div>\n        <div class=\"col-sm-4\">\n          <input class=\"form-control\" id=\"field-"+a+"-value\" type=\"text\" placeholder=\"value\" value=\""+(y.fields[a].value===void 0?"":y.fields[a].value)+"\" />\n        </div>\n        <div class=\"col-sm-2\">\n          <div class=\"form-check\">\n            <label class=\"form-check-label\">\n              <input class=\"form-check-input\" id=\"field-"+a+"-inline\" type=\"checkbox\" "+(y.fields[a].inline===void 0?"":"checked=\"checked\"")+"> Inline\n            </label>\n          </div>\n        </div>\n        <div class=\"col-sm-2\">\n          <button id=\"field-"+a+"-delete\" class=\"btn btn-danger select\">Delete</button>\n        </div>\n      </div>"),$("#field-"+a+"-name").keyup(function(){e(a,$("#field-"+a+"-name").val())}),$("#field-"+a+"-value").keyup(function(){f(a,$("#field-"+a+"-value").val())}),$("#field-"+a+"-inline").click(function(){g(a,$("#field-"+a+"-inline").is(":checked"))}),$("#field-"+a+"-delete").click(function(b){b.preventDefault(),h(a)})},c=0;c<a;c++){if(!y.fields[c])return;b(c)}$(".input-fields").append("<button id=\"add-field\" class=\"btn btn-success select\">Add field</button>"),$("#add-field").click(function(a){a.preventDefault(),i()})}function d(){var a=document.querySelector("#copy-input");a.setAttribute("type","text"),a.setAttribute("value",JSON.stringify(y)),a.select(),document.execCommand("copy"),a.setAttribute("type","hidden"),window.getSelection().removeAllRanges()}function e(a,c){y.fields[a].name=c,b(y)}function f(a,c){y.fields[a].value=c,b(y)}function g(a,c){y.fields[a].inline=c,b(y)}function h(a){y.fields.splice(a,1),b(y),w-=1,c(w)}function i(){y.fields.push({inline:!0}),w+=1,c(w)}function j(a){y.title=a||"",b(y)}function k(a){y.url=a||"",b(y)}function l(a){y.thumbnail.url=a||null,b(y)}function m(a){y.image.url=a||null,b(y)}function n(a){y.description=a||"",b(y)}function o(a){y.color=a||"#00FF00",b(y)}function p(a){y.author.name=a||"",b(y)}function q(a){y.author.url=a||"",b(y)}function r(a){y.author.icon_url=a||"",b(y)}function s(a){y.footer.text=a||"",b(y)}// checking helpers
function t(a,b,c){a.addClass("form-control-warning"),a.removeClass("form-control-success"),a.parent().addClass("has-warning"),a.parent().removeClass("has-success"),0===$("#"+b+"-feedback").length&&a.after("<div class=\"form-control-feedback\" id=\""+b+"-feedback\">"+c+"</div>")}function u(a,b){a.removeClass("form-control-warning"),a.addClass("form-control-success"),a.parent().addClass("has-success"),a.parent().removeClass("has-warning"),$("#"+b+"-feedback").remove()}var v=new showdown.Converter,w=0,x={title:"",author:{name:"",url:"",icon_url:""},image:{url:""},description:"",url:"",thumbnail:{url:""},color:"#000000",fields:[],footer:{text:""}},y=Object.assign({},x);b(y),c(w),$("#form").submit(function(a){a.preventDefault()}),$("#select-edit").click(function(){document.getElementById("edit-input").style.visibility="visible"}),$("#edit-input").keyup(function(){var a=document.getElementById("edit-input").value;try{var d=Object.keys(y),e=JSON.parse(a);d.forEach(function(a){y[a]=e[a]&&_typeof(e[a])===_typeof(x[a])?e[a]:x[a]}),b(y),w=y.fields?y.fields.length:0,c(w),$("#title").get(0).value=y.title||null,$("#url").get(0).value=y.url||null,$("#icon").get(0).value=y.thumbnail.url||null,$("#image").get(0).value=y.image.url||null,$("#author_icon").get(0).value=(y.author?y.author.icon_url:null)||null,$("#author_name").get(0).value=(y.author?y.author.name:null)||null,$("#author_url").get(0).value=(y.author?y.author.url:null)||null,$("#description").get(0).value=y.description||null,$("#color").get(0).value=y.color||null,$("#footer").get(0).value=y.footer.text||null}catch(a){}}),$("#copy-source").click(function(a){a.preventDefault(),d()}),$("#title").keyup(function(){var a=$("#title"),b=a.val();// update
j(b)}),$("#url").keyup(function(){var a=$("#url"),b=a.val();"http"===b.substr(0,4)||0===b.length||b.startsWith("{")?(u(a,"url"),k(b)):t(a,"url","not a valid url or a valid variable")}),$("#icon").keyup(function(){var a=$("#icon"),b=a.val();"http"===b.substr(0,4)||0===b.length||b.startsWith("{")?(u(a,"icon"),l(b)):t(a,"icon","not a valid url or a valid variable")}),$("#image").keyup(function(){var a=$("#image"),b=a.val();"http"===b.substr(0,4)||0===b.length||b.startsWith("{")?(u(a,"image"),m(b)):t(a,"image","not a valid url or a valid variable")}),$("#description").keyup(function(){var a=$("#description"),b=a.val();// update
u(a,"description"),n(b)}),$("#color").change(function(){o($("#color").val())}),$("#author_name").keyup(function(){var a=$("#author_name"),b=a.val();// update
u(a,"author_name"),p(b)}),$("#author_url").keyup(function(){var a=$("#author_url"),b=a.val();"http"===b.substr(0,4)||0===b.length||b.startsWith("{")?(u(a,"author_url"),q(b)):t(a,"author_url","not a valid url or a valid variable")}),$("#author_icon").keyup(function(){var a=$("#author_icon"),b=a.val();"http"===b.substr(0,4)||0===b.length||b.startsWith("{")?(u(a,"author_icon"),r(b)):t(a,"author_icon","not a valid url or a valid variable")}),$("#footer").keyup(function(){var a=$("#footer"),b=a.val();// update
u(a,"footer"),s(b)})});